C51 COMPILER V9.56.0.0   MAIN                                                              01/01/2019 22:52:35 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\OBJ\MAIN.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE MAIN.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\USER;..\SY
                    -STEM;..\SYSTEM\delay;..\SYSTEM\uart;..\SYSTEM\adc;..\SYSTEM\eeprom;..\SYSTEM\timer;..\SYSTEM\pca;..\SYSTEM\spi;..\HARDWA
                    -RE\NRF24L01;..\HARDWARE\Rocker;..\APP\NRF_DT) DEFINE(STC_Y5,FOSC=11059200L,UART_BAUD=115200,UART_PARITYBIT=ODD_PARITY,TE
                    -ST_MODE=1,NRF_CAR_SLAVE,ROCKER_SUM=1) DEBUG OBJECTEXTEND PRINT(.\Listings\MAIN.lst) OBJECT(..\OBJ\MAIN.obj)

line level    source

   1          /**********************************************************************
   2          -  File name : MAIN.c
   3          -  Author : yueling_liu Version: 0.1    Date: 2018年10月01日星期一
   4          -  Description :        main
   5          -  History :
   6             NO.<author>          <time>          <version>       <desc>
   7             1.yueling_liu        18/10/01        0.1                     project initial
   8          **********************************************************************/
   9          
  10          //--Header File--//
  11          #include "SYS.H"
  12          #include "delay.h"
  13          #include "uart.h"
  14          #include "timer.h"
  15          #include "NRF24L01.h"
  16          #include "spi.h"
  17          #include "adc.h"
  18          #include "Rocker.h"
  19          #include "NRF_DT.h"
  20          
  21          sbit LED_RUN = P5^4;
  22          sbit Rocker1_Key = P2^2;
  23          //sbit Rocker2_Key = P2^3;
  24          /**********************************************************************
  25          -  Function :           void System_Init(void)
  26          -  Description :        System_Init
  27          **********************************************************************/
  28          void System_Init(void)
  29          {
  30   1              /*MCLK Init*/
  31   1              CLK_DIV = 0x00; 
  32   1              
  33   1              {/*IO_Init; P0-P7 IO_MODE:准双向IO*/
  34   2                      P0M0 = 0x00;
  35   2                      P0M1 = 0x00;
  36   2                      P1M0 = 0x00;
  37   2                      P1M1 = 0x00;
  38   2                      P2M0 = 0x00;
  39   2                      P2M1 = 0x00;
  40   2                      P3M0 = 0x00;
  41   2                      P3M1 = 0x00;
  42   2                      P4M0 = 0x00;
  43   2                      P4M1 = 0x00;
  44   2                      P5M0 = 0x00;
  45   2                      P5M1 = 0x00;
  46   2                      P6M0 = 0x00;
  47   2                      P6M1 = 0x00;
  48   2                      P7M0 = 0x00;
  49   2                      P7M1 = 0x00;
  50   2              }
  51   1              
  52   1              {/*LED_RUN OFF*/
C51 COMPILER V9.56.0.0   MAIN                                                              01/01/2019 22:52:35 PAGE 2   

  53   2                      LED_RUN = 1;                    //LED OFF
  54   2              }
  55   1      
  56   1              {/*IO Init*/
  57   2      /*Rocker1_Key IO Init*/
  58   2      #ifdef NRF_CAR_MASTER
              {
                      #if (ROCKER_SUM == 1)
                      {
                              Rocker1_Key = 1;
                      }
                      #endif
                      #if (ROCKER_SUM == 2)
                      {
                              Rocker1_Key = 1;
                              Rocker2_Key = 1;
                      }
                      #endif
              }
              #endif
  73   2      
  74   2      /*Output IO Init*/
  75   2      #ifdef NRF_CAR_SLAVE
  76   2      {
  77   3                      
  78   3      }
  79   2      #endif
  80   2              }
  81   1              
  82   1              EA = 1;                         //开启总中断
  83   1              
  84   1      #if (TEST_MODE == 1)    //UART Lock
  85   1      {
  86   2              UART_Init();            //串口初始化
  87   2      }
  88   1      #endif
  89   1              
  90   1      #ifdef NRF_CAR_MASTER
              {
                      UART_SendString("NRF CAR MASTER DEMO\r\n");
                      UART_SendString("DEMO Version: 0.1\r\n");
                      Timer0_1MS_Init();      //Timer0初始化
                      UART_SendString("Timer0 Init\r\n");
              }
              #endif
  98   1      
  99   1      #if NRF_CAR_SLAVE
*** ERROR C308 IN LINE 99 OF MAIN.c: invalid integer const expression
              {
                      UART_SendString("NRF CAR SLAVE DEMO\r\n");
                      UART_SendString("DEMO Version: 0.1\r\n");
              }
              #endif
 105   1              
 106   1              NRF24L01_Init();        //NRF24L01初始化
 107   1              UART_SendString("NRF24L01 Init\r\n");
 108   1              UART_SendString("NRF24L01 Check...\r\n");
 109   1              while(NRF24L01_Check())//检查NRF是否存在
 110   1              {
 111   2                      Delay200ms();
 112   2                      UART_SendString("NRF24L01 Check Error\r\n");
 113   2              }
C51 COMPILER V9.56.0.0   MAIN                                                              01/01/2019 22:52:35 PAGE 3   

 114   1              UART_SendString("NRF24L01 Check OK\r\n");
 115   1              Delay200ms();
 116   1              
 117   1      #ifdef NRF_CAR_MASTER 
              {
                      /*发射机相关初始化*/
                      NRF24L01_TX_Mode();//配置NRF24L01为Tx模式
                      UART_SendString("NRF24L01 TX Mode\r\n");
                      Adc_Init();//ADC初始化
              }
              #endif
 125   1      
 126   1      #if NRF_CAR_SLAVE
*** ERROR C308 IN LINE 126 OF MAIN.c: invalid integer const expression
              {
                      /*接收机相关初始化*/
                      NRF24L01_RX_Mode();//配置NRF24L01到RX模式
                      UART_SendString("NRF24L01 RX Mode\r\n");
                      
                              //电机运动相关初始化
              }
              #endif
 135   1              
 136   1              UART_SendString("System Init OK\r\n");
 137   1      }
 138          
 139          
 140          /**********************************************************************
 141          -  Function :           int main(void)
 142          -  Description :        main
 143          **********************************************************************/
 144          int main(void)
 145          {
 146   1              System_Init();//系统初始化
 147   1              
 148   1              while(1)
 149   1              {
 150   2                      NRF_DT();
 151   2              }
 152   1              
 153   1      }
 154          
 155          
 156          
 157          
 158          
 159          

C51 COMPILATION COMPLETE.  0 WARNING(S),  2 ERROR(S)
